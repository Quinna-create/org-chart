<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Shinsengumi Org Chart</title>

  <!-- match the timeline typography -->
  <link href="https://fonts.googleapis.com/css?family=Noto+Serif+JP:700|Roboto:400,700&display=swap" rel="stylesheet">

  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg:#000;
      --card-bg-1:#232834;
      --card-bg-2:#1f2226;
      --panel:#3a3a3a;
      --gold:#bba14f;
      --gold-2:#bfae8e;
      --muted:#60748a;
      --parchment-url: url('https://www.transparenttextures.com/patterns/old-mathematics.png');
    }

    /* page basics */
    html,body{height:100%;margin:0;background:var(--bg);color:#fff;font-family:'Roboto',Arial,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}
    .wrap{max-width:1200px;margin:20px auto;padding:18px;box-sizing:border-box;}

    /* header */
    .title{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      margin-bottom:16px;
    }
    .title h1{
      margin:0;
      font-family:'Noto Serif JP',serif;
      color:var(--gold);
      font-size:1.4rem;
      line-height:1.05;
    }
    .title .sub{
      color:var(--gold-2);
      font-weight:700;
      margin-top:4px;
      font-family:'Noto Serif JP',serif;
    }

    /* top leaders */
    .top-leaders{display:flex;justify-content:center;gap:36px;flex-wrap:wrap;margin-bottom:22px;}
    .org-node{
      background:linear-gradient(180deg,var(--card-bg-1),var(--card-bg-2));
      border:2px solid var(--gold);
      border-radius:12px;
      padding:12px 18px;
      text-align:center;
      min-width:220px;
      max-width:360px;
      box-shadow:0 6px 20px rgba(0,0,0,0.6);
    }
    .org-node .jp{font-family:'Noto Serif JP',serif;color:var(--gold);font-weight:700;font-size:1.05em;}
    .org-node .meta{color:var(--gold-2);font-weight:600;margin-top:6px;font-size:0.9em;}

    /* grid of cards - increased gap significantly to prevent overlap and keep text readable */
    .divisions-inspectors{
      display:grid;
      grid-template-columns: repeat(auto-fit,minmax(170px,1fr));
      gap:28px; /* increased gap to reduce overlap and keep front text visible */
      align-items:start;
      justify-items:center;
      width:100%;
      padding: 0 10px; /* added horizontal padding to give more breathing room */
    }

    /* card base to match timeline event cards */
    .org-card{
      width: 170px;
      min-height: 92px;
      position:relative;
      cursor:pointer;
      border-radius:12px;
      transform-origin:center;
      transition:transform .16s ease, z-index .01s;
      -webkit-tap-highlight-color: transparent;
      margin: 0;
    }
    /* minimal hover effect to avoid covering adjacent cards */
    .org-card:hover{transform:translateY(-3px) scale(1.005); z-index:12;}

    /* front/back stacked; "dissolve" effect */
    .card-front, .card-back {
      position:absolute;
      left:0;top:0;width:100%;height:100%;
      border-radius:12px;
      overflow:hidden;
      box-sizing:border-box;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:10px;
      transition:opacity 420ms cubic-bezier(.2,.9,.2,1), transform 420ms cubic-bezier(.2,.9,.2,1), filter 420ms;
      backface-visibility:hidden;
      -webkit-backface-visibility:hidden;
      -moz-osx-font-smoothing:grayscale;
    }

    /* front style now uses the parchment-like textured background (like the timeline year labels) */
    .card-front{
      background:
        linear-gradient(135deg, rgba(243,233,210,0.98) 60%, rgba(191,174,142,0.98) 100%),
        var(--parchment-url);
      background-blend-mode: multiply;
      border:1.5px solid rgba(140,126,88,0.95);
      color:var(--gold);
      font-weight:700;
      box-shadow: 2px 2px 8px rgba(0,0,0,0.6);
      z-index:4;
      text-align:center;
      flex-direction:column;
      letter-spacing:0.02em;
      padding:12px 10px;
      min-height: 84px;
    }
    .card-front .jp{font-family:'Noto Serif JP',serif;font-weight:700;font-size:1.02rem;margin-bottom:4px;color:#8c7e58;}
    .card-front .small{font-family:'Roboto',sans-serif;color:var(--gold-2);font-weight:600;font-size:0.86rem;}

    /* back is hidden by default; contains a semi-transparent background panel (.back-panel) and content (.back-content) */
    .card-back{
      z-index:2;
      opacity:0;
      transform: translateY(6px) scale(.995);
      pointer-events:none;
    }
    .back-panel{
      position:absolute;inset:0;
      background: rgba(20,20,20,0.56); /* semi-transparent panel behind the back content */
      border-radius:12px;
      border:1px solid rgba(187,161,79,0.09);
      backdrop-filter: blur(4px) saturate(.95);
      box-shadow: 0 10px 30px rgba(0,0,0,0.6), 0 2px 6px rgba(187,161,79,0.04) inset;
    }
    .back-content{
      position:relative;
      z-index:3;
      padding:10px 12px;
      color:#fff;
      text-align:left;
      width:100%;
      height:100%;
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap:6px;
      font-family:'Roboto',sans-serif;
      font-size:0.88rem;
      line-height:1.15;
    }
    .back-content .name{font-weight:700;color:var(--gold);font-family:'Noto Serif JP',serif;}
    .back-content .meta{color:var(--gold-2);font-weight:600;font-size:0.86rem;}
    .back-content .meta .label{display:inline-block;color:#c9d7e4;font-weight:700;margin-right:6px;font-size:0.82rem;color:var(--gold-2);}

    /* hover triggers dissolve: front fades/blur, back fades in on its panel */
    .org-card:hover .card-front{
      opacity:0;
      transform: translateY(-3px) scale(.99);
      filter: blur(2px) saturate(.9);
      pointer-events:none;
    }
    .org-card:hover .card-back{
      opacity:1;
      transform: translateY(0) scale(1);
      pointer-events:auto;
    }

    /* crowded backs smaller */
    .card-back.inspectors-crowded .back-content{font-size:0.78rem;line-height:1.05;}

    /* responsive: for small screens let content flow vertically and allow scrolling */
    @media (max-width:700px){
      .wrap{padding:12px;}
      .divisions-inspectors{grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px;}
      .org-card{width:92vw;max-width:340px;min-height:86px;}
      .org-node{min-width:unset;width:92vw;max-width:560px;}
      .org-card:hover{transform:none;}
      .card-front{background:
        linear-gradient(135deg, rgba(243,233,210,0.95) 60%, rgba(191,174,142,0.95) 100%),
        var(--parchment-url);
        background-blend-mode:multiply;
      }
    }

    /* Japanese emphasis */
    .jp, :lang(ja){font-family:'Noto Serif JP',serif;font-weight:700;color:var(--gold);letter-spacing:0.6px;}
  </style>
</head>
<body>
  <div class="wrap" id="wrap">
    <div class="title">
      <div>
        <h1>新選組血風録<br>Shinsengumi: Org Chart</h1>
        <div class="sub">(Hover each card to reveal hometown & sword school)</div>
      </div>
    </div>

    <div class="top-leaders" role="group" aria-label="Top leaders">
      <div class="org-node" role="article">
        <div class="jp">局長</div>
        <div class="meta">Commander Kondō Isami</div>
        <div style="margin-top:8px;color:var(--gold-2);font-size:.88rem;">Hometown: Musashi • Sword school: Tennen Rishinryū</div>
      </div>

      <div class="org-node" role="article">
        <div class="jp">副長</div>
        <div class="meta">Lieutenant Hijikata Toshizō</div>
        <div style="margin-top:8px;color:var(--gold-2);font-size:.88rem;">Hometown: Musashi • Sword school: Tennen Rishinryū</div>
      </div>
    </div>

    <div class="divisions-inspectors" id="cardsGrid" role="list" aria-label="Divisions and inspectors">

      <!-- Inspector / Staff Officer -->
      <div class="org-card" role="listitem" tabindex="0">
        <div class="card-front" aria-hidden="false">
          <div class="jp">参謀</div>
          <div class="small">Staff Officer</div>
        </div>
        <div class="card-back" aria-hidden="true">
          <div class="back-panel"></div>
          <div class="back-content">
            <div class="name">Itō Kashitarō</div>
            <div class="meta"><span class="label">Hometown</span>Shizuku</div>
            <div class="meta"><span class="label">Sword school</span>Shintō Munenryū</div>
          </div>
        </div>
      </div>

      <!-- Inspectors (crowded) -->
      <div class="org-card" role="listitem" tabindex="0">
        <div class="card-front">
          <div class="jp">監察組</div>
          <div class="small">Inspector Division</div>
        </div>
        <div class="card-back inspectors-crowded">
          <div class="back-panel"></div>
          <div class="back-content">
            <div class="name">Yamazaki Susumu</div>
            <div class="meta"><span class="label">Hometown</span>Musashi</div>
            <div class="meta"><span class="label">Sword school</span>Kyōshin Meichi</div>
            <hr style="opacity:.06;margin:8px 0;border:none;height:1px;background:#fff">
            <div class="name">Shinohara Tainoshin</div>
            <div class="meta"><span class="label">Hometown</span>Ukiha</div>
            <div class="meta"><span class="label">Sword school</span>Hokushin / Ryōishintō (jū-jutsu)</div>
          </div>
        </div>
      </div>

      <!-- 1st Division -->
      <div class="org-card" role="listitem" tabindex="0">
        <div class="card-front">
          <div class="jp">一番隊</div>
          <div class="small">1st Division</div>
        </div>
        <div class="card-back">
          <div class="back-panel"></div>
          <div class="back-content">
            <div class="name">Corporal Okita Sōji</div>
            <div class="meta"><span class="label">Hometown</span>Edo (family from Shirakawa)</div>
            <div class="meta"><span class="label">Sword school</span>Tennen Rishinryū</div>
          </div>
        </div>
      </div>

      <!-- 2nd Division -->
      <div class="org-card" role="listitem" tabindex="0">
        <div class="card-front">
          <div class="jp">二番隊</div>
          <div class="small">2nd Division</div>
        </div>
        <div class="card-back">
          <div class="back-panel"></div>
          <div class="back-content">
            <div class="name">Corporal Nagakura Shinpachi</div>
            <div class="meta"><span class="label">Hometown</span>Edo (Matsumae)</div>
            <div class="meta"><span class="label">Sword school</span>Shintō Munenryū</div>
          </div>
        </div>
      </div>

      <!-- 3rd Division -->
      <div class="org-card" role="listitem" tabindex="0">
        <div class="card-front">
          <div class="jp">三番隊</div>
          <div class="small">3rd Division</div>
        </div>
        <div class="card-back">
          <div class="back-panel"></div>
          <div class="back-content">
            <div class="name">Corporal Saitō Hajime</div>
            <div class="meta"><span class="label">Hometown</span>Edo</div>
            <div class="meta"><span class="label">Sword school</span>Ittōryū</div>
          </div>
        </div>
      </div>

      <!-- 4th Division -->
      <div class="org-card" role="listitem" tabindex="0">
        <div class="card-front">
          <div class="jp">四番隊</div>
          <div class="small">4th Division</div>
        </div>
        <div class="card-back">
          <div class="back-panel"></div>
          <div class="back-content">
            <div class="name">Corporal Matsubara Chūji</div>
            <div class="meta"><span class="label">Hometown</span>Musashi</div>
            <div class="meta"><span class="label">Sword school</span>Tennen Rishinryū</div>
          </div>
        </div>
      </div>

      <!-- 5th Division -->
      <div class="org-card" role="listitem" tabindex="0">
        <div class="card-front">
          <div class="jp">五番隊</div>
          <div class="small">5th Division</div>
        </div>
        <div class="card-back">
          <div class="back-panel"></div>
          <div class="back-content">
            <div class="name">Corporal Takeda Kanryūsai</div>
            <div class="meta"><span class="label">Hometown</span>Izumo</div>
            <div class="meta"><span class="label">Sword school</span>Hokushin Ittōryū</div>
          </div>
        </div>
      </div>

      <!-- 6th Division -->
      <div class="org-card" role="listitem" tabindex="0">
        <div class="card-front">
          <div class="jp">六番隊</div>
          <div class="small">6th Division</div>
        </div>
        <div class="card-back">
          <div class="back-panel"></div>
          <div class="back-content">
            <div class="name">Corporal Inōe Genzaburō</div>
            <div class="meta"><span class="label">Hometown</span>Musashi</div>
            <div class="meta"><span class="label">Sword school</span>Tennen Rishinryū</div>
          </div>
        </div>
      </div>

      <!-- 7th Division -->
      <div class="org-card" role="listitem" tabindex="0">
        <div class="card-front">
          <div class="jp">七番隊</div>
          <div class="small">7th Division</div>
        </div>
        <div class="card-back">
          <div class="back-panel"></div>
          <div class="back-content">
            <div class="name">Corporal Tani Sanjūrō</div>
            <div class="meta"><span class="label">Hometown</span>Matsuyama</div>
            <div class="meta"><span class="label">Sword school</span>Tyokushinryū • Taneda Hōzōinryū (spear)</div>
          </div>
        </div>
      </div>

      <!-- 8th Division -->
      <div class="org-card" role="listitem" tabindex="0">
        <div class="card-front">
          <div class="jp">八番隊</div>
          <div class="small">8th Division</div>
        </div>
        <div class="card-back">
          <div class="back-panel"></div>
          <div class="back-content">
            <div class="name">Corporal Todō Heisuke</div>
            <div class="meta"><span class="label">Hometown</span>Edo</div>
            <div class="meta"><span class="label">Sword school</span>Hokushin Ittōryū</div>
          </div>
        </div>
      </div>

      <!-- 9th Division -->
      <div class="org-card" role="listitem" tabindex="0">
        <div class="card-front">
          <div class="jp">九番隊</div>
          <div class="small">9th Division</div>
        </div>
        <div class="card-back">
          <div class="back-panel"></div>
          <div class="back-content">
            <div class="name">Corporal Suzuki Mikisaburō</div>
            <div class="meta"><span class="label">Hometown</span>Shizuku</div>
            <div class="meta"><span class="label">Sword school</span>Shintō Munenryū</div>
          </div>
        </div>
      </div>

      <!-- 10th Division -->
      <div class="org-card" role="listitem" tabindex="0">
        <div class="card-front">
          <div class="jp">十番隊</div>
          <div class="small">10th Division</div>
        </div>
        <div class="card-back">
          <div class="back-panel"></div>
          <div class="back-content">
            <div class="name">Corporal Harada Sanosuke</div>
            <div class="meta"><span class="label">Hometown</span>Iyo-Matsuyama</div>
            <div class="meta"><span class="label">Sword school</span>Taneda Hōzōinryū (spear)</div>
          </div>
        </div>
      </div>

      <!-- add more cards as needed -->
    </div>
  </div>

  <script>
    // Small script to scale the wrap so cards fit on a single viewport height on desktop,
    // but allow normal scroll on narrow screens. This preserves the "one page" constraint.
    (function fitToViewport(){
      const wrap = document.getElementById('wrap');
      function update(){
        if(window.innerWidth < 700){
          wrap.style.transform = 'none';
          document.body.style.overflowY = 'auto';
          return;
        }
        const avail = window.innerHeight - 32; // breathing room
        const content = wrap.scrollHeight;
        let scale = 1;
        if(content > avail){
          scale = (avail / content) * 0.98;
          scale = Math.max(scale, 0.62); // avoid unreadably small numbers
        }
        wrap.style.transform = `scale(${scale})`;
        wrap.style.transformOrigin = 'top center';
        document.body.style.overflow = (scale < 1) ? 'hidden' : 'auto';
      }
      window.addEventListener('load', update);
      window.addEventListener('resize', update);
      setTimeout(update,300);
      const ro = new ResizeObserver(update);
      ro.observe(wrap);
    })();

    // Accessibility: allow keyboard to trigger hover-like behavior (show back on focus)
    document.querySelectorAll('.org-card').forEach(card=>{
      card.addEventListener('focus',()=> {
        card.classList.add('focused');
        card.querySelector('.card-front').style.opacity = '0';
        const back = card.querySelector('.card-back');
        back.style.opacity = '1';
        back.style.pointerEvents = 'auto';
      });
      card.addEventListener('blur',()=> {
        card.classList.remove('focused');
        card.querySelector('.card-front').style.opacity = '';
        const back = card.querySelector('.card-back');
        back.style.opacity = '';
        back.style.pointerEvents = '';
      });
    });
  </script>
</body>
</html>
